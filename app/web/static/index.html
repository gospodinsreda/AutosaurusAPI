<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BotasaurusAPI - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button.active { background-color: #3b82f6; color: white; }
        .action-form { display: none; }
        .action-form.active { display: block; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="bg-white shadow-lg rounded-lg p-6 mb-8">
            <h1 class="text-4xl font-bold text-gray-800">ü¶ï Autosaurus API</h1>
            <p class="text-gray-600 mt-2">–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π</p>
        </header>

        <!-- Navigation Tabs -->
        <div class="bg-white shadow-lg rounded-lg mb-8">
            <div class="flex flex-wrap border-b">
                <button class="tab-button active px-6 py-4 font-semibold text-gray-700 hover:bg-gray-100 transition" data-tab="sessions">
                    üìã –°–µ—Å—Å–∏–∏
                </button>
                <button class="tab-button px-6 py-4 font-semibold text-gray-700 hover:bg-gray-100 transition" data-tab="actions">
                    ‚ö° –î–µ–π—Å—Ç–≤–∏—è
                </button>
                <button class="tab-button px-6 py-4 font-semibold text-gray-700 hover:bg-gray-100 transition" data-tab="scripts">
                    üìù –°–∫—Ä–∏–ø—Ç—ã
                </button>
                <button class="tab-button px-6 py-4 font-semibold text-gray-700 hover:bg-gray-100 transition" data-tab="ai-agent">
                    ü§ñ AI –ê–≥–µ–Ω—Ç
                </button>
                <button class="tab-button px-6 py-4 font-semibold text-gray-700 hover:bg-gray-100 transition" data-tab="settings">
                    ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
            </div>

            <!-- Sessions Tab -->
            <div id="sessions" class="tab-content active p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏</h2>
                    <button onclick="showCreateSessionForm()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold transition">
                        ‚ûï –°–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é
                    </button>
                </div>

                <!-- Create Session Form (Hidden by default) -->
                <div id="create-session-form" class="bg-gray-50 p-6 rounded-lg mb-6 hidden">
                    <h3 class="text-xl font-bold mb-4">–ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">URL:</label>
                            <input type="text" id="session-url" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="https://example.com">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">–®–∏—Ä–∏–Ω–∞:</label>
                            <input type="number" id="session-width" value="1920" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">–í—ã—Å–æ—Ç–∞:</label>
                            <input type="number" id="session-height" value="1080" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold mb-2">–ë—Ä–∞—É–∑–µ—Ä:</label>
                            <select id="session-browser" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="chromium">Chromium</option>
                                <option value="firefox">Firefox</option>
                                <option value="webkit">WebKit</option>
                            </select>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="session-headless" class="mr-2">
                            <label class="text-sm font-semibold">Headless —Ä–µ–∂–∏–º</label>
                        </div>
                    </div>
                    <div class="flex gap-4 mt-4">
                        <button onclick="createSession()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg font-semibold transition">
                            –°–æ–∑–¥–∞—Ç—å
                        </button>
                        <button onclick="hideCreateSessionForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-semibold transition">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </div>

                <!-- Sessions List -->
                <div id="sessions-list" class="space-y-4"></div>
            </div>

            <!-- Actions Tab -->
            <div id="actions" class="tab-content p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-semibold mb-2">–°–µ—Å—Å–∏—è:</label>
                        <select id="action-session" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">–î–µ–π—Å—Ç–≤–∏–µ:</label>
                        <select id="action-type" onchange="showActionForm()" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ...</option>
                            <option value="navigate">–ü–µ—Ä–µ–π—Ç–∏ –ø–æ URL</option>
                            <option value="click">–ö–ª–∏–∫ –ø–æ —ç–ª–µ–º–µ–Ω—Ç—É</option>
                            <option value="type">–í–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç</option>
                            <option value="scroll">–ü—Ä–æ–∫—Ä—É—Ç–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</option>
                            <option value="wait">–ü–æ–¥–æ–∂–¥–∞—Ç—å</option>
                            <option value="screenshot">–°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç</option>
                            <option value="get_text">–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç —ç–ª–µ–º–µ–Ω—Ç–∞</option>
                            <option value="get_attribute">–ü–æ–ª—É—á–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç</option>
                            <option value="select_option">–í—ã–±—Ä–∞—Ç—å –æ–ø—Ü–∏—é</option>
                            <option value="hover">–ù–∞–≤–µ—Å—Ç–∏ –∫—É—Ä—Å–æ—Ä</option>
                            <option value="press_key">–ù–∞–∂–∞—Ç—å –∫–ª–∞–≤–∏—à—É</option>
                            <option value="fill_form">–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É</option>
                            <option value="execute_js">–í—ã–ø–æ–ª–Ω–∏—Ç—å JavaScript</option>
                            <option value="get_cookies">–ü–æ–ª—É—á–∏—Ç—å cookies</option>
                            <option value="set_cookies">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å cookies</option>
                            <option value="clear_cookies">–û—á–∏—Å—Ç–∏—Ç—å cookies</option>
                            <option value="go_back">–ù–∞–∑–∞–¥</option>
                            <option value="go_forward">–í–ø–µ—Ä–µ–¥</option>
                            <option value="refresh">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</option>
                            <option value="get_title">–ü–æ–ª—É—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫</option>
                            <option value="get_url">–ü–æ–ª—É—á–∏—Ç—å URL</option>
                            <option value="wait_for_element">–ñ–¥–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç</option>
                            <option value="wait_for_selector">–ñ–¥–∞—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä</option>
                            <option value="is_visible">–í–∏–¥–µ–Ω –ª–∏ —ç–ª–µ–º–µ–Ω—Ç</option>
                            <option value="is_enabled">–ê–∫—Ç–∏–≤–µ–Ω –ª–∏ —ç–ª–µ–º–µ–Ω—Ç</option>
                            <option value="get_elements">–ü–æ–ª—É—á–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã</option>
                            <option value="count_elements">–ü–æ–¥—Å—á–∏—Ç–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã</option>
                            <option value="drag_and_drop">Drag & Drop</option>
                            <option value="upload_file">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</option>
                            <option value="download_file">–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</option>
                            <option value="switch_frame">–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ñ—Ä–µ–π–º</option>
                            <option value="switch_to_default">–í –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç</option>
                            <option value="open_new_tab">–û—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É</option>
                            <option value="close_tab">–ó–∞–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É</option>
                            <option value="switch_tab">–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–∫–ª–∞–¥–∫—É</option>
                            <option value="get_page_source">–ü–æ–ª—É—á–∏—Ç—å HTML</option>
                            <option value="set_viewport">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å viewport</option>
                            <option value="emulate_device">–≠–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</option>
                            <option value="set_geolocation">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é</option>
                            <option value="block_urls">–ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å URL</option>
                            <option value="set_user_agent">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å User-Agent</option>
                            <option value="clear_input">–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ –≤–≤–æ–¥–∞</option>
                            <option value="check_checkbox">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ–∫–±–æ–∫—Å</option>
                            <option value="uncheck_checkbox">–°–Ω—è—Ç—å —á–µ–∫–±–æ–∫—Å</option>
                            <option value="get_element_count">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤</option>
                            <option value="wait_for_navigation">–ñ–¥–∞—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é</option>
                            <option value="wait_for_load">–ñ–¥–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É</option>
                            <option value="get_local_storage">–ü–æ–ª—É—á–∏—Ç—å localStorage</option>
                            <option value="set_local_storage">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å localStorage</option>
                            <option value="clear_local_storage">–û—á–∏—Å—Ç–∏—Ç—å localStorage</option>
                            <option value="get_session_storage">–ü–æ–ª—É—á–∏—Ç—å sessionStorage</option>
                            <option value="set_session_storage">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å sessionStorage</option>
                            <option value="clear_session_storage">–û—á–∏—Å—Ç–∏—Ç—å sessionStorage</option>
                            <option value="accept_alert">–ü—Ä–∏–Ω—è—Ç—å alert</option>
                            <option value="dismiss_alert">–û—Ç–∫–ª–æ–Ω–∏—Ç—å alert</option>
                            <option value="get_alert_text">–¢–µ–∫—Å—Ç alert</option>
                            <option value="send_keys_to_alert">–í–≤–µ—Å—Ç–∏ –≤ alert</option>
                            <option value="double_click">–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫</option>
                            <option value="right_click">–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫</option>
                            <option value="focus">–§–æ–∫—É—Å –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç</option>
                            <option value="blur">–£–±—Ä–∞—Ç—å —Ñ–æ–∫—É—Å</option>
                            <option value="get_computed_style">–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∏–ª–∏</option>
                            <option value="is_checked">–û—Ç–º–µ—á–µ–Ω –ª–∏</option>
                            <option value="is_selected">–í—ã–±—Ä–∞–Ω –ª–∏</option>
                        </select>
                    </div>
                </div>

                <!-- Dynamic Action Forms -->
                <div id="action-forms" class="bg-gray-50 p-6 rounded-lg mb-6">
                    <p class="text-gray-500 text-center">–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ä–º—ã</p>
                </div>

                <button onclick="executeAction()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-semibold transition w-full md:w-auto">
                    ‚ñ∂Ô∏è –í—ã–ø–æ–ª–Ω–∏—Ç—å
                </button>

                <!-- Action Result -->
                <div id="action-result" class="mt-6 bg-white p-6 rounded-lg shadow hidden">
                    <h3 class="text-xl font-bold mb-4">–†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
                    <pre id="action-result-content" class="bg-gray-100 p-4 rounded text-sm overflow-auto max-h-96"></pre>
                </div>
            </div>

            <!-- Scripts Tab -->
            <div id="scripts" class="tab-content p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞–º–∏</h2>
                    <button onclick="showNewScriptForm()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold transition">
                        ‚ûï –ù–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
                    </button>
                </div>

                <!-- Script Editor -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <div>
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">–†–µ–¥–∞–∫—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–∞</h3>
                            <select id="script-session" class="px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é...</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-semibold mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞:</label>
                            <input type="text" id="script-name" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="–ú–æ–π —Å–∫—Ä–∏–ø—Ç">
                        </div>
                        <label class="block text-sm font-semibold mb-2">JSON —Å–∫—Ä–∏–ø—Ç:</label>
                        <textarea id="script-editor" class="w-full h-96 px-4 py-2 border rounded-lg font-mono text-sm focus:ring-2 focus:ring-blue-500" placeholder='[
  {
    "action": "navigate",
    "url": "https://example.com"
  },
  {
    "action": "click",
    "selector": "#button"
  }
]'></textarea>
                        <div class="flex gap-2 mt-4">
                            <button onclick="runScript()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg font-semibold transition">
                                ‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å
                            </button>
                            <button onclick="saveScript()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition">
                                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                            <button onclick="clearScriptEditor()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-semibold transition">
                                üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-xl font-bold mb-4">–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã</h3>
                        <div id="saved-scripts" class="space-y-2 max-h-96 overflow-auto"></div>
                    </div>
                </div>

                <!-- Script Result -->
                <div id="script-result" class="bg-white p-6 rounded-lg shadow hidden">
                    <h3 class="text-xl font-bold mb-4">–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</h3>
                    <pre id="script-result-content" class="bg-gray-100 p-4 rounded text-sm overflow-auto max-h-96"></pre>
                </div>
            </div>

            <!-- AI Agent Tab -->
            <div id="ai-agent" class="tab-content p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">ü§ñ AI –ê–≥–µ–Ω—Ç</h2>

                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                    <p class="text-sm text-yellow-800">
                        <strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ AI –º–æ–¥–µ–ª—å –≤ —Ä–∞–∑–¥–µ–ª–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º.
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-semibold mb-2">–°–µ—Å—Å–∏—è:</label>
                        <select id="ai-session" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é...</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">–ú–∞–∫—Å–∏–º—É–º —à–∞–≥–æ–≤:</label>
                        <div class="flex items-center gap-4">
                            <input type="range" id="ai-max-steps" min="1" max="50" value="10" class="flex-1">
                            <span id="ai-max-steps-value" class="font-bold text-lg">10</span>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-semibold mb-2">–¶–µ–ª—å (—á—Ç–æ –¥–æ–ª–∂–µ–Ω —Å–¥–µ–ª–∞—Ç—å –∞–≥–µ–Ω—Ç):</label>
                    <textarea id="ai-goal" rows="4" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–∞–π—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ Python –Ω–∞ Wikipedia –∏ —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç"></textarea>
                </div>

                <button onclick="runAIAgent()" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold transition w-full md:w-auto">
                    üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å AI –ê–≥–µ–Ω—Ç–∞
                </button>

                <!-- AI Agent Output -->
                <div id="ai-output" class="mt-6 space-y-4">
                    <!-- Conversation History -->
                    <div id="ai-conversation" class="bg-white p-6 rounded-lg shadow hidden">
                        <h3 class="text-xl font-bold mb-4">üí¨ –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞:</h3>
                        <div id="ai-conversation-content" class="space-y-4 max-h-96 overflow-auto"></div>
                    </div>

                    <!-- Action Transcript -->
                    <div id="ai-transcript" class="bg-white p-6 rounded-lg shadow hidden">
                        <h3 class="text-xl font-bold mb-4">üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:</h3>
                        <div id="ai-transcript-content" class="space-y-2 max-h-96 overflow-auto"></div>
                    </div>

                    <!-- Final Result -->
                    <div id="ai-final-result" class="bg-white p-6 rounded-lg shadow hidden">
                        <h3 class="text-xl font-bold mb-4">‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
                        <pre id="ai-final-result-content" class="bg-gray-100 p-4 rounded text-sm overflow-auto max-h-96"></pre>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings" class="tab-content p-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI</h2>

                <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                    <p class="text-sm text-blue-800">
                        <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ LM Studio –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –º–æ–¥–µ–ª–µ–π. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –≤ LM Studio –∏ —É–∫–∞–∂–∏—Ç–µ endpoint (–æ–±—ã—á–Ω–æ http://localhost:1234/v1).
                    </p>
                </div>

                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-sm font-semibold mb-2">AI Endpoint:</label>
                        <input type="text" id="ai-endpoint" value="http://localhost:1234/v1" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="http://localhost:1234/v1">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2">API Key (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                        <input type="password" id="ai-api-key" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π">
                    </div>

                    <div class="flex gap-4">
                        <button onclick="fetchModelsFromLMStudio()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition">
                            üîÑ –ü–æ–ª—É—á–∏—Ç—å –º–æ–¥–µ–ª–∏ –∏–∑ LM Studio
                        </button>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2">–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å:</label>
                        <select id="ai-model" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                            <option value="">–°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π...</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2">–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞:</label>
                        <div class="flex items-center gap-4">
                            <input type="range" id="ai-temperature" min="0" max="2" step="0.1" value="0.7" class="flex-1">
                            <span id="ai-temperature-value" class="font-bold text-lg">0.7</span>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold mb-2">Max Tokens:</label>
                        <input type="number" id="ai-max-tokens" value="2000" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>

                    <div class="flex items-center">
                        <input type="checkbox" id="ai-enabled" checked class="mr-2 w-5 h-5">
                        <label class="text-sm font-semibold">–í–∫–ª—é—á–∏—Ç—å AI –∞–≥–µ–Ω—Ç–∞</label>
                    </div>
                </div>

                <button onclick="saveAISettings()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-semibold transition w-full md:w-auto">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>

                <div id="settings-status" class="mt-4 p-4 rounded-lg hidden"></div>
            </div>
        </div>
    </div>

    <script>
        // API Base URL
        const API_BASE = window.location.origin;
        
        // State
        let sessions = [];
        let savedScripts = JSON.parse(localStorage.getItem('scripts') || '[]');
        let aiSettings = JSON.parse(localStorage.getItem('aiSettings') || '{"endpoint": "http://localhost:1234/v1", "model": "", "temperature": 0.7, "maxTokens": 2000, "enabled": true, "apiKey": ""}');

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            setupTabs();
            loadSessions();
            loadSavedScripts();
            loadAISettings();
            setupSliders();
        });

        // Tab Management
        function setupTabs() {
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.dataset.tab;
                    
                    // Update buttons
                    document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Update content
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    document.getElementById(tabName).classList.add('active');
                });
            });
        }

        // Sliders
        function setupSliders() {
            const maxStepsSlider = document.getElementById('ai-max-steps');
            const maxStepsValue = document.getElementById('ai-max-steps-value');
            maxStepsSlider.addEventListener('input', (e) => {
                maxStepsValue.textContent = e.target.value;
            });

            const tempSlider = document.getElementById('ai-temperature');
            const tempValue = document.getElementById('ai-temperature-value');
            tempSlider.addEventListener('input', (e) => {
                tempValue.textContent = parseFloat(e.target.value).toFixed(1);
            });
        }

        // Sessions Management
        async function loadSessions() {
            try {
                const response = await fetch(`${API_BASE}/sessions`);
                sessions = await response.json();
                renderSessions();
                updateSessionDropdowns();
            } catch (error) {
                console.error('Error loading sessions:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–µ—Å—Å–∏–π', 'error');
            }
        }

        function renderSessions() {
            const container = document.getElementById('sessions-list');
            
            if (sessions.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã.</p>';
                return;
            }

            container.innerHTML = sessions.map(session => `
                <div class="bg-white p-4 rounded-lg shadow flex justify-between items-center">
                    <div>
                        <h3 class="font-bold text-lg">${session.session_id}</h3>
                        <p class="text-sm text-gray-600">–ë—Ä–∞—É–∑–µ—Ä: ${session.browser_type || 'chromium'} | URL: ${session.current_url || 'N/A'}</p>
                        <p class="text-xs text-gray-500">–°–æ–∑–¥–∞–Ω–∞: ${new Date(session.created_at).toLocaleString('ru-RU')}</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="viewSession('${session.session_id}')" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded font-semibold transition">
                            üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä
                        </button>
                        <button onclick="closeSession('${session.session_id}')" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded font-semibold transition">
                            ‚è∏Ô∏è –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                        <button onclick="removeSession('${session.session_id}')" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded font-semibold transition">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateSessionDropdowns() {
            const dropdowns = ['action-session', 'script-session', 'ai-session'];
            dropdowns.forEach(id => {
                const select = document.getElementById(id);
                select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é...</option>' + 
                    sessions.map(s => `<option value="${s.session_id}">${s.session_id}</option>`).join('');
            });
        }

        function showCreateSessionForm() {
            document.getElementById('create-session-form').classList.remove('hidden');
        }

        function hideCreateSessionForm() {
            document.getElementById('create-session-form').classList.add('hidden');
        }

        async function createSession() {
            const config = {
                url: document.getElementById('session-url').value,
                width: parseInt(document.getElementById('session-width').value),
                height: parseInt(document.getElementById('session-height').value),
                browser_type: document.getElementById('session-browser').value,
                headless: document.getElementById('session-headless').checked
            };

            try {
                const response = await fetch(`${API_BASE}/sessions/create`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });
                
                if (response.ok) {
                    showNotification('–°–µ—Å—Å–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!', 'success');
                    hideCreateSessionForm();
                    await loadSessions();
                } else {
                    const error = await response.json();
                    showNotification(`–û—à–∏–±–∫–∞: ${error.detail}`, 'error');
                }
            } catch (error) {
                console.error('Error creating session:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏', 'error');
            }
        }

        async function viewSession(sessionId) {
            try {
                const response = await fetch(`${API_BASE}/sessions/${sessionId}`);
                const data = await response.json();
                alert(`–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Å—Å–∏–∏:\n\n${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                console.error('Error viewing session:', error);
                showNotification('–û—à–∏–±–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–µ—Å—Å–∏–∏', 'error');
            }
        }

        async function closeSession(sessionId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–∫—Ä—ã—Ç—å —ç—Ç—É —Å–µ—Å—Å–∏—é?')) return;

            try {
                const response = await fetch(`${API_BASE}/sessions/${sessionId}/close`, {
                    method: 'POST'
                });
                
                if (response.ok) {
                    showNotification('–°–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∞', 'success');
                    await loadSessions();
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–µ—Å—Å–∏–∏', 'error');
                }
            } catch (error) {
                console.error('Error closing session:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–µ—Å—Å–∏–∏', 'error');
            }
        }

        async function removeSession(sessionId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å–µ—Å—Å–∏—é?')) return;

            try {
                const response = await fetch(`${API_BASE}/sessions/${sessionId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showNotification('–°–µ—Å—Å–∏—è —É–¥–∞–ª–µ–Ω–∞', 'success');
                    await loadSessions();
                } else {
                    showNotification('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏', 'error');
                }
            } catch (error) {
                console.error('Error removing session:', error);
                showNotification('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏', 'error');
            }
        }

        // Actions Management
        function showActionForm() {
            const actionType = document.getElementById('action-type').value;
            const container = document.getElementById('action-forms');
            
            if (!actionType) {
                container.innerHTML = '<p class="text-gray-500 text-center">–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ñ–æ—Ä–º—ã</p>';
                return;
            }

            const forms = {
                navigate: '<label class="block text-sm font-semibold mb-2">URL:</label><input type="text" id="param-url" class="w-full px-4 py-2 border rounded-lg" placeholder="https://example.com">',
                
                click: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä:</label><input type="text" id="param-selector" class="w-full px-4 py-2 border rounded-lg" placeholder="#button, .class, xpath=//button">',
                
                type: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä:</label><input type="text" id="param-selector" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">–¢–µ–∫—Å—Ç:</label><input type="text" id="param-text" class="w-full px-4 py-2 border rounded-lg">',
                
                scroll: '<label class="block text-sm font-semibold mb-2">X:</label><input type="number" id="param-x" value="0" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">Y:</label><input type="number" id="param-y" value="500" class="w-full px-4 py-2 border rounded-lg">',
                
                wait: '<label class="block text-sm font-semibold mb-2">–í—Ä–µ–º—è (–º—Å):</label><input type="number" id="param-time" value="1000" class="w-full px-4 py-2 border rounded-lg">',
                
                screenshot: '<label class="block text-sm font-semibold mb-2">–ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label><input type="text" id="param-path" class="w-full px-4 py-2 border rounded-lg" placeholder="screenshot.png">',
                
                get_text: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä:</label><input type="text" id="param-selector" class="w-full px-4 py-2 border rounded-lg">',
                
                get_attribute: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä:</label><input type="text" id="param-selector" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">–ê—Ç—Ä–∏–±—É—Ç:</label><input type="text" id="param-attribute" class="w-full px-4 py-2 border rounded-lg" placeholder="href, class, id">',
                
                select_option: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä:</label><input type="text" id="param-selector" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">–ó–Ω–∞—á–µ–Ω–∏–µ:</label><input type="text" id="param-value" class="w-full px-4 py-2 border rounded-lg">',
                
                hover: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä:</label><input type="text" id="param-selector" class="w-full px-4 py-2 border rounded-lg">',
                
                press_key: '<label class="block text-sm font-semibold mb-2">–ö–ª–∞–≤–∏—à–∞:</label><input type="text" id="param-key" class="w-full px-4 py-2 border rounded-lg" placeholder="Enter, Escape, Tab, Space">',
                
                execute_js: '<label class="block text-sm font-semibold mb-2">JavaScript –∫–æ–¥:</label><textarea id="param-code" rows="4" class="w-full px-4 py-2 border rounded-lg font-mono" placeholder="return document.title;"></textarea>',
                
                set_cookies: '<label class="block text-sm font-semibold mb-2">Cookies (JSON):</label><textarea id="param-cookies" rows="4" class="w-full px-4 py-2 border rounded-lg font-mono" placeholder=\'[{"name": "test", "value": "123"}]\'></textarea>',
                
                wait_for_element: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä:</label><input type="text" id="param-selector" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">Timeout (–º—Å):</label><input type="number" id="param-timeout" value="30000" class="w-full px-4 py-2 border rounded-lg">',
                
                upload_file: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä:</label><input type="text" id="param-selector" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É:</label><input type="text" id="param-path" class="w-full px-4 py-2 border rounded-lg">',
                
                set_viewport: '<label class="block text-sm font-semibold mb-2">–®–∏—Ä–∏–Ω–∞:</label><input type="number" id="param-width" value="1920" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">–í—ã—Å–æ—Ç–∞:</label><input type="number" id="param-height" value="1080" class="w-full px-4 py-2 border rounded-lg">',
                
                set_geolocation: '<label class="block text-sm font-semibold mb-2">–®–∏—Ä–æ—Ç–∞:</label><input type="number" id="param-latitude" step="0.0001" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">–î–æ–ª–≥–æ—Ç–∞:</label><input type="number" id="param-longitude" step="0.0001" class="w-full px-4 py-2 border rounded-lg">',
                
                set_user_agent: '<label class="block text-sm font-semibold mb-2">User-Agent:</label><input type="text" id="param-user-agent" class="w-full px-4 py-2 border rounded-lg">',
                
                drag_and_drop: '<label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä –∏—Å—Ç–æ—á–Ω–∏–∫–∞:</label><input type="text" id="param-source" class="w-full px-4 py-2 border rounded-lg mb-4"><label class="block text-sm font-semibold mb-2">–°–µ–ª–µ–∫—Ç–æ—Ä —Ü–µ–ª–∏:</label><input type="text" id="param-target" class="w-full px-4 py-2 border rounded-lg">',
            };

            container.innerHTML = forms[actionType] || '<p class="text-gray-500 text-center">–§–æ—Ä–º–∞ –¥–ª—è —ç—Ç–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p>';
        }

        async function executeAction() {
            const sessionId = document.getElementById('action-session').value;
            const actionType = document.getElementById('action-type').value;

            if (!sessionId || !actionType) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é –∏ –¥–µ–π—Å—Ç–≤–∏–µ', 'error');
                return;
            }

            // Build action payload based on type
            const action = { action: actionType };
            
            // Add parameters based on action type
            const paramMap = {
                navigate: ['url'],
                click: ['selector'],
                type: ['selector', 'text'],
                scroll: ['x', 'y'],
                wait: ['time'],
                screenshot: ['path'],
                get_text: ['selector'],
                get_attribute: ['selector', 'attribute'],
                select_option: ['selector', 'value'],
                hover: ['selector'],
                press_key: ['key'],
                execute_js: ['code'],
                set_cookies: ['cookies'],
                wait_for_element: ['selector', 'timeout'],
                upload_file: ['selector', 'path'],
                set_viewport: ['width', 'height'],
                set_geolocation: ['latitude', 'longitude'],
                set_user_agent: ['user-agent'],
                drag_and_drop: ['source', 'target']
            };

            if (paramMap[actionType]) {
                paramMap[actionType].forEach(param => {
                    const element = document.getElementById(`param-${param}`);
                    if (element) {
                        let value = element.value;
                        // Try to parse JSON for specific fields
                        if (param === 'cookies' && value) {
                            try {
                                value = JSON.parse(value);
                            } catch (e) {
                                showNotification('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –¥–ª—è cookies', 'error');
                                return;
                            }
                        }
                        // Convert numbers
                        if (['x', 'y', 'time', 'timeout', 'width', 'height', 'latitude', 'longitude'].includes(param)) {
                            value = parseFloat(value);
                        }
                        action[param.replace('-', '_')] = value;
                    }
                });
            }

            try {
                const response = await fetch(`${API_BASE}/sessions/${sessionId}/action`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(action)
                });

                const result = await response.json();
                
                // Show result
                document.getElementById('action-result').classList.remove('hidden');
                document.getElementById('action-result-content').textContent = JSON.stringify(result, null, 2);
                
                if (response.ok) {
                    showNotification('–î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ', 'success');
                } else {
                    showNotification(`–û—à–∏–±–∫–∞: ${result.detail}`, 'error');
                }
            } catch (error) {
                console.error('Error executing action:', error);
                showNotification('–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è', 'error');
            }
        }

        // Scripts Management
        function loadSavedScripts() {
            const container = document.getElementById('saved-scripts');
            
            if (savedScripts.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤</p>';
                return;
            }

            container.innerHTML = savedScripts.map((script, index) => `
                <div class="bg-gray-100 p-4 rounded-lg flex justify-between items-center">
                    <div>
                        <h4 class="font-bold">${script.name}</h4>
                        <p class="text-xs text-gray-600">${script.actions.length} –¥–µ–π—Å—Ç–≤–∏–π</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="loadScript(${index})" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm">
                            üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å
                        </button>
                        <button onclick="deleteScript(${index})" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showNewScriptForm() {
            document.getElementById('script-name').value = '';
            document.getElementById('script-editor').value = '';
        }

        function saveScript() {
            const name = document.getElementById('script-name').value.trim();
            const editorContent = document.getElementById('script-editor').value.trim();

            if (!name || !editorContent) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫—Ä–∏–ø—Ç–∞', 'error');
                return;
            }

            try {
                const actions = JSON.parse(editorContent);
                savedScripts.push({ name, actions });
                localStorage.setItem('scripts', JSON.stringify(savedScripts));
                loadSavedScripts();
                showNotification('–°–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω', 'success');
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON', 'error');
            }
        }

        function loadScript(index) {
            const script = savedScripts[index];
            document.getElementById('script-name').value = script.name;
            document.getElementById('script-editor').value = JSON.stringify(script.actions, null, 2);
            showNotification('–°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä', 'success');
        }

        function deleteScript(index) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç?')) return;
            savedScripts.splice(index, 1);
            localStorage.setItem('scripts', JSON.stringify(savedScripts));
            loadSavedScripts();
            showNotification('–°–∫—Ä–∏–ø—Ç —É–¥–∞–ª—ë–Ω', 'success');
        }

        function clearScriptEditor() {
            document.getElementById('script-name').value = '';
            document.getElementById('script-editor').value = '';
        }

        async function runScript() {
            const sessionId = document.getElementById('script-session').value;
            const editorContent = document.getElementById('script-editor').value.trim();

            if (!sessionId || !editorContent) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é –∏ –≤–≤–µ–¥–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç', 'error');
                return;
            }

            try {
                const actions = JSON.parse(editorContent);
                
                const response = await fetch(`${API_BASE}/sessions/${sessionId}/script`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ actions })
                });

                const result = await response.json();
                
                document.getElementById('script-result').classList.remove('hidden');
                document.getElementById('script-result-content').textContent = JSON.stringify(result, null, 2);
                
                if (response.ok) {
                    showNotification('–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
                } else {
                    showNotification(`–û—à–∏–±–∫–∞: ${result.detail}`, 'error');
                }
            } catch (error) {
                console.error('Error running script:', error);
                showNotification('–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞', 'error');
            }
        }

        // AI Agent
        async function runAIAgent() {
            const sessionId = document.getElementById('ai-session').value;
            const goal = document.getElementById('ai-goal').value.trim();
            const maxSteps = parseInt(document.getElementById('ai-max-steps').value);

            if (!sessionId || !goal) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é –∏ –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª—å', 'error');
                return;
            }

            if (!aiSettings.enabled) {
                showNotification('AI –∞–≥–µ–Ω—Ç –æ—Ç–∫–ª—é—á–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö', 'error');
                return;
            }

            if (!aiSettings.model) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö', 'error');
                return;
            }

            // Show output sections
            document.getElementById('ai-conversation').classList.remove('hidden');
            document.getElementById('ai-transcript').classList.remove('hidden');
            document.getElementById('ai-final-result').classList.remove('hidden');
            
            // Clear previous content
            document.getElementById('ai-conversation-content').innerHTML = '<p class="text-gray-500">–ó–∞–ø—É—Å–∫ AI –∞–≥–µ–Ω—Ç–∞...</p>';
            document.getElementById('ai-transcript-content').innerHTML = '';
            document.getElementById('ai-final-result-content').textContent = '';

            try {
                const payload = {
                    goal,
                    max_steps: maxSteps,
                    ai_config: {
                        endpoint: aiSettings.endpoint,
                        model: aiSettings.model,
                        temperature: aiSettings.temperature,
                        max_tokens: aiSettings.maxTokens,
                        api_key: aiSettings.apiKey || undefined
                    }
                };

                const response = await fetch(`${API_BASE}/sessions/${sessionId}/ai-agent`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                
                // Display conversation
                if (result.conversation) {
                    const conversationHtml = result.conversation.map(msg => `
                        <div class="border-l-4 ${msg.role === 'user' ? 'border-blue-500 bg-blue-50' : 'border-green-500 bg-green-50'} p-3 rounded">
                            <div class="font-bold text-sm mb-1">${msg.role === 'user' ? 'üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å' : 'ü§ñ AI'}</div>
                            <div class="text-sm">${msg.content}</div>
                        </div>
                    `).join('');
                    document.getElementById('ai-conversation-content').innerHTML = conversationHtml;
                }

                // Display actions transcript
                if (result.actions_taken) {
                    const transcriptHtml = result.actions_taken.map((action, i) => `
                        <div class="text-sm bg-gray-100 p-2 rounded">
                            <span class="font-bold">${i + 1}.</span> ${action.action} 
                            ${action.success ? '‚úÖ' : '‚ùå'}
                        </div>
                    `).join('');
                    document.getElementById('ai-transcript-content').innerHTML = transcriptHtml;
                }

                // Display final result
                document.getElementById('ai-final-result-content').textContent = JSON.stringify(result, null, 2);
                
                if (response.ok && result.success) {
                    showNotification('AI –∞–≥–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É —É—Å–ø–µ—à–Ω–æ', 'success');
                } else {
                    showNotification(`AI –∞–≥–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–∞–º–∏`, 'error');
                }
            } catch (error) {
                console.error('Error running AI agent:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ AI –∞–≥–µ–Ω—Ç–∞', 'error');
                document.getElementById('ai-conversation-content').innerHTML = `<p class="text-red-500">–û—à–∏–±–∫–∞: ${error.message}</p>`;
            }
        }

        // AI Settings
        function loadAISettings() {
            document.getElementById('ai-endpoint').value = aiSettings.endpoint;
            document.getElementById('ai-model').value = aiSettings.model;
            document.getElementById('ai-temperature').value = aiSettings.temperature;
            document.getElementById('ai-temperature-value').textContent = aiSettings.temperature.toFixed(1);
            document.getElementById('ai-max-tokens').value = aiSettings.maxTokens;
            document.getElementById('ai-enabled').checked = aiSettings.enabled;
            document.getElementById('ai-api-key').value = aiSettings.apiKey || '';
        }

        function saveAISettings() {
            aiSettings = {
                endpoint: document.getElementById('ai-endpoint').value,
                model: document.getElementById('ai-model').value,
                temperature: parseFloat(document.getElementById('ai-temperature').value),
                maxTokens: parseInt(document.getElementById('ai-max-tokens').value),
                enabled: document.getElementById('ai-enabled').checked,
                apiKey: document.getElementById('ai-api-key').value
            };
            
            localStorage.setItem('aiSettings', JSON.stringify(aiSettings));
            showSettingsStatus('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        }

        async function fetchModelsFromLMStudio() {
            const endpoint = document.getElementById('ai-endpoint').value;
            
            if (!endpoint) {
                showSettingsStatus('–í–≤–µ–¥–∏—Ç–µ AI endpoint', 'error');
                return;
            }

            try {
                const response = await fetch(`${endpoint}/models`, {
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                const data = await response.json();
                const select = document.getElementById('ai-model');
                
                if (data.data && data.data.length > 0) {
                    select.innerHTML = data.data.map(model => 
                        `<option value="${model.id}">${model.id}</option>`
                    ).join('');
                    showSettingsStatus(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${data.data.length} –º–æ–¥–µ–ª–µ–π`, 'success');
                } else {
                    showSettingsStatus('–ú–æ–¥–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã', 'error');
                }
            } catch (error) {
                console.error('Error fetching models:', error);
                showSettingsStatus('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ endpoint –∏ —á—Ç–æ LM Studio –∑–∞–ø—É—â–µ–Ω.', 'error');
            }
        }

        function showSettingsStatus(message, type) {
            const statusDiv = document.getElementById('settings-status');
            statusDiv.className = `mt-4 p-4 rounded-lg ${type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`;
            statusDiv.textContent = message;
            statusDiv.classList.remove('hidden');
            
            setTimeout(() => {
                statusDiv.classList.add('hidden');
            }, 3000);
        }

        // Notifications
        function showNotification(message, type = 'info') {
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500'
            };

            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-opacity`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>
